import{r as d,W as M,j as e}from"./app-74bb848f.js";import{h as _,n as x,o as V,s as I,q as A,A as B,S as Y}from"./AuthenticatedLayout-0ad038d2.js";import{S as H}from"./MenuComponent-84cafbd8.js";import{F as C}from"./index-7045e541.js";/* empty css                  */import{S as L}from"./StatusComponent-6e456040.js";import{C as O}from"./ConfirmationMessage-f3bbbca3.js";import{w as U}from"./sweetalert2-react-content.es-af8bf8f1.js";import"./MetronicSplashScreen-01c28a04.js";import"./hoist-non-react-statics.cjs-1d8f9095.js";const z=U(Y),G=i=>{var N=new URLSearchParams(window.location.search);const y=d.useRef(null),l=d.useRef(null),[c,o]=d.useState({product_name:"",substance_name:"",dossier_type:"",document_count:""}),[k,w]=d.useState(!1),[D,W]=d.useState(""),{folder:s}=i;var m=i.auth.user.trigramme;m=m==null?void 0:m.toUpperCase();const{data:a,setData:p,post:g,processing:$,errors:J,clearErrors:K,reset:Q}=M({id:s?s._id:"",form:s?s.form:"Formatting",region:s?s.region:N.get("region"),coredoc:s?s.coreDoc:N.get("coreDoc"),dossier_contact:s?s.dossier_contact:m,object:s?s.object:"",product_name:s?s.product_name:"",substance_name:s?s.substance_name:"",country:s?s.country:"",dossier_type:s?s.dossier_type:"",document_count:s?s.document_count:"",deficiency_letter:s?s.deficiency_letter:"",chrono:s?s.chrono:"",remarks:s?s.remarks:"",doc:s&&s.document!==null?s.document:[],docremarks:s?s.docremarks:"",request_date:new Date,deadline:new Date,adjusted_deadline:_(new Date),delivery_remarks:"",review_request_date:_(new Date),review_deadline:_(new Date),delivery_comment:"",delivery_version:"",correction_request:"",correction_origin:"",status:s?s.status:"",created_by:i.auth.user.id,car_deadline:s?s.car_deadline:!1});let S=i.countries.map(function(t){return{value:t.name,label:t.name,code:t.code}});d.useEffect(()=>{l.current=H.createInsance(y.current)},[]);const q=()=>{if(l.current){if(l.current.getCurrentStepIndex()===1&&(!a.product_name||!a.substance_name||!a.dossier_type||!a.document_count)){a.product_name||o(t=>({...t,product_name:"this field is required"})),a.substance_name||o(t=>({...t,substance_name:"this field is required"})),a.dossier_type||o(t=>({...t,dossier_type:"this field is required"})),a.document_count||o(t=>({...t,document_count:"this field is required"}));return}l.current.getCurrentStepIndex(),l.current.goNext()}},P=()=>{l.current&&l.current.goPrev()},b=t=>({control:n=>({...n,...t&&{borderColor:"red !important"}})}),u=t=>{console.log(t.target.name,t.target.checked),t.target.name=="document_count"&&o(n=>({...n,document_count:""})),p(t.target.name,t.target.value)},F=t=>{p(t.target.name,t.target.checked)},h=(t,n)=>{n=="product_name"&&o(r=>({...r,product_name:""})),n=="substance_name"&&o(r=>({...r,substance_name:""})),n=="dossier_type"&&o(r=>({...r,dossier_type:""})),p(n,t)};d.useEffect(()=>{let t=new Date,n=t.getHours(),r=a.dossier_type?a.dossier_type.delai:0,f=new Date,v=1;for(n<12?r=r:r=r+1;v<r;)f=new Date(t.setDate(t.getDate()+1)),f.getDay()!=0&&f.getDay()!=6&&v++;p("deadline",new Date(f))},[a.dossier_type]);const j=(t,n)=>{t.preventDefault(),z.fire({title:n=="save"?'Click on "Yes" to save your request or click on "No, return" to return to the form.':'Click on "Yes" to submit your request or click on "No, return" to return to the form.',icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, proceed!",cancelButtonText:"No, return"}).then(r=>{r.isConfirmed&&g(route("initiate-formatting",{type:n}))})},E=()=>{w(!1)},T=t=>{g(route("initiate-formatting",{type:t}))},R=t=>{var n;!a.product_name||!a.substance_name||!a.dossier_type||!a.document_count?(a.product_name||o(r=>({...r,product_name:"this field is required"})),a.substance_name||o(r=>({...r,substance_name:"this field is required"})),a.dossier_type||o(r=>({...r,dossier_type:"this field is required"})),a.document_count||o(r=>({...r,document_count:"this field is required"}))):(n=l.current)==null||n.goto(t)};return e.jsxs(e.Fragment,{children:[s?e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("a",{href:"#",onClick:()=>window.history.back(),className:"btn btn-sm fw-bold btn-secondary mb-2",children:e.jsx("i",{className:"ki-duotone ki-black-left fs-3"})}),e.jsx(L,{status:a.status})]}):"",e.jsxs("div",{className:"stepper stepper-pills",id:"kt_stepper_example_basic",ref:y,children:[e.jsxs("div",{className:"stepper-nav flex-center flex-wrap mb-10",children:[e.jsxs("div",{className:"stepper-item mx-8 my-4 current","data-kt-stepper-element":"nav",children:[e.jsxs("div",{className:"stepper-wrapper d-flex align-items-center",onClick:()=>{var t;return(t=l.current)==null?void 0:t.goto(1)},style:{cursor:"pointer"},children:[e.jsxs("div",{className:"stepper-icon w-40px h-40px",children:[e.jsx("i",{className:"stepper-check fas fa-check"}),e.jsx("span",{className:"stepper-number",children:"1"})]}),e.jsxs("div",{className:"stepper-label",children:[e.jsx("h3",{className:"stepper-title",children:"Step 1"}),e.jsx("div",{className:"stepper-desc",children:"General Information"})]})]}),e.jsx("div",{className:"stepper-line h-40px"})]}),e.jsxs("div",{className:"stepper-item mx-8 my-4","data-kt-stepper-element":"nav",children:[e.jsxs("div",{className:"stepper-wrapper d-flex align-items-center",onClick:()=>R(2),style:{cursor:"pointer"},children:[e.jsxs("div",{className:"stepper-icon w-40px h-40px",children:[e.jsx("i",{className:"stepper-check fas fa-check"}),e.jsx("span",{className:"stepper-number",children:"2"})]}),e.jsxs("div",{className:"stepper-label",children:[e.jsx("h3",{className:"stepper-title",children:"Step 2"}),e.jsx("div",{className:"stepper-desc",children:"Delivery Details"})]})]}),e.jsx("div",{className:"stepper-line h-40px"})]})]}),e.jsxs("form",{className:"form",id:"kt_stepper_example_basic_form",onSubmit:j,children:[e.jsxs("div",{className:"mb-5",children:[e.jsxs("div",{className:"flex-column current","data-kt-stepper-element":"content",children:[e.jsxs("div",{className:"row mb-10",children:[e.jsxs("div",{className:"col-md-6 col-lg-6 col-sm-12",children:[e.jsx("label",{className:"form-label",title:"Trigram of the current user",children:"Dossier contact"}),e.jsx("input",{type:"text",className:"form-control form-control-solid",defaultValue:a.dossier_contact,name:"dossier_contact",disabled:!0})]}),e.jsxs("div",{className:"col-md-6 col-lg-6 col-sm-12",children:[e.jsx("label",{htmlFor:"object",className:"form-label","data-toggle":"tooltip",title:"Enter a Dossier Title. Ex : Variation Prick ragweed irradiation",children:"Object"}),e.jsx("input",{type:"text",className:"form-control form-control-solid",defaultValue:a.object,name:"object",id:"object",title:"Enter a Dossier Title. Ex : Variation Prick ragweed irradiation",onChange:u})]})]}),e.jsxs("div",{className:"row mb-10",children:[e.jsxs("div",{className:"col-md-6 col-lg-6 col-sm-12",children:[e.jsx("label",{htmlFor:"product_name",className:"form-label",title:"Choose the product name to appear in document headers",style:{color:c.product_name?"red":""},children:"Product name (*)"}),e.jsx(x,{options:V,name:"product_name",onChange:t=>h(t,"product_name"),placeholder:"",isClearable:!0,menuPortalTarget:document.body,styles:b(c.product_name),value:a.product_name,className:"react-select-container",classNamePrefix:"react-select"})]}),e.jsxs("div",{className:"col-md-6 col-lg-6 col-sm-12",children:[e.jsx("label",{className:"form-label",title:"Choose the substance name to appear in document headers",style:{color:c.substance_name?"red":""},children:"Substance name (*)"}),e.jsx(x,{options:I,name:"substance_name",onChange:t=>h(t,"substance_name"),placeholder:"",isClearable:!0,menuPortalTarget:document.body,value:a.substance_name,className:"react-select-container",classNamePrefix:"react-select",styles:b(c.substance_name)})]})]}),e.jsxs("div",{className:"row mb-10",children:[e.jsxs("div",{className:"col-md-6 col-lg-6 col-sm-12",children:[e.jsx("label",{className:"form-label",title:"Choose a country if applicable",children:"Country"}),e.jsx(x,{options:S,name:"country",onChange:t=>h(t,"country"),placeholder:"",isClearable:!0,menuPortalTarget:document.body,styles:{menuPortal:t=>({...t,zIndex:9999})},value:a.country,className:"react-select-container",classNamePrefix:"react-select"})]}),e.jsxs("div",{className:"col-md-6 col-lg-6 col-sm-12",children:[e.jsx("label",{className:"form-label",title:"Choose the Dossier type ",style:{color:c.dossier_type?"red":""},children:"Dossier type (*)"}),e.jsx(x,{options:A,name:"dossier_type",onChange:t=>h(t,"dossier_type"),placeholder:"",isClearable:!0,menuPortalTarget:document.body,styles:b(c.dossier_type),value:a.dossier_type,className:"react-select-container",classNamePrefix:"react-select"})]})]}),e.jsxs("div",{className:"row mb-10",children:[e.jsxs("div",{className:"col-md-4 col-lg-4 col-sm-12",children:[e.jsx("label",{className:"form-label",title:"Enter the number of documents for formatting",style:{color:c.document_count?"red":""},children:"Document Count (*)"}),e.jsx("input",{type:"number",className:"form-control form-control-solid",defaultValue:a.document_count,style:{borderColor:c.document_count?"red":""},name:"document_count",onChange:u})]}),e.jsxs("div",{className:"col-md-4 col-lg-4 col-sm-12",children:[e.jsx("label",{className:"form-label",children:"Deficiency Letter"}),e.jsx("input",{type:"text",className:"form-control form-control-solid",defaultValue:a.deficiency_letter,name:"deficiency_letter",onChange:u})]}),e.jsxs("div",{className:"col-md-4 col-lg-4 col-sm-12",children:[e.jsx("label",{className:"form-label",children:"Chrono NÂ°/ Dossier Reference"}),e.jsx("input",{type:"text",className:"form-control form-control-solid",name:"chrono",defaultValue:a.chrono,onChange:u})]})]}),e.jsxs("div",{className:"row mb-10",children:[e.jsx("label",{className:"form-label",title:"Provide dossier description or additional comments ",children:"Remarks"}),e.jsx("textarea",{className:"form-control form-control-solid",rows:3,defaultValue:a.remarks,name:"remarks",onChange:u})]})]}),e.jsxs("div",{className:"flex-column","data-kt-stepper-element":"content",children:[e.jsxs("div",{className:"row mb-10",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"",className:"form-label",title:"Automatic Field for the request submission date",children:"Request date"}),e.jsx(C,{"data-enable-time":!0,value:a.request_date,className:"form-control",options:{dateFormat:"d-M-Y H:i"},disabled:!0})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"",className:"form-label",title:"Calculated field for the delivery date based on dossier type",children:"Delivery deadline"}),e.jsx(C,{"data-enable-time":!0,value:a.deadline,className:"form-control",options:{dateFormat:"d-M-Y H:i"},disabled:!0})]})]}),e.jsx("div",{className:"mb-10",children:e.jsxs("div",{className:"my-4",style:{display:"flex",alignItems:"center"},children:[e.jsx("label",{className:"form-label my-0 me-4","data-toggle":"tooltip",title:"Field for the CAR adjusted deadline",children:"Urgent Request"}),e.jsx("label",{className:"form-check form-switch form-check-custom form-check-solid",children:e.jsx("input",{className:"form-check-input",name:"car_deadline",type:"checkbox",value:a.car_deadline,onChange:F})})]})})]})]}),e.jsxs("div",{className:"d-flex flex-stack",children:[e.jsx("div",{className:"me-2",children:e.jsx("button",{type:"button",className:"btn btn-light btn-active-light-primary","data-kt-stepper-action":"previous",onClick:P,children:"Back"})}),e.jsxs("div",{children:[e.jsx("button",{type:"button",className:"btn btn-primary m-3","data-kt-stepper-action":"submit",onClick:t=>j(t,"save"),children:e.jsx("span",{className:"indicator-label",children:"Save"})}),e.jsxs("button",{type:"button",className:"btn btn-primary","data-kt-stepper-action":"submit",onClick:t=>j(t,"submit"),children:[e.jsx("span",{className:"indicator-label",children:"Submit"}),e.jsxs("span",{className:"indicator-progress",children:["Please wait... ",e.jsx("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]}),e.jsx("button",{type:"button",className:"btn btn-primary","data-kt-stepper-action":"next",onClick:q,children:"Continue"})]})]})]})]}),e.jsx(O,{show:k,onCancel:E,actionType:D,onConfirm:T})]})};G.layout=i=>e.jsx(B,{children:i,auth:i.props.auth});export{G as default};
